
{% extends "base.html" %}

{% macro metric_card(label, value, sublabel=None) -%}
<div class="metric-card">
  <div class="metric-label">{{ label }}</div>
  <div class="metric-value">{{ value if value is not none else '—' }}</div>
  {% if sublabel %}<div class="metric-sublabel">{{ sublabel }}</div>{% endif %}
</div>
{%- endmacro %}

{% block title %}RansomLook — Open ransomware intelligence{% endblock %}

{% block content %}
<section class="hero">
  <div class="container">
    <!-- Logo centré sans encadré -->
    <div class="hero-logo">
      <img src="{{ url_for('static', filename=logo) }}"
           alt="RansomLook logo"
           class="hero-logo-img">
    </div>

    <h1>{{ _('Welcome to RansomLook') if _ else 'Welcome to RansomLook' }}</h1>
    <p class="lead">
      {{ _('Open-source project providing real-time ransomware intelligence.') 
         if _ else 'Open-source project providing real-time ransomware intelligence.' }}
    </p>

    <div class="cta-row">
      <a href="/recent" class="btn btn-primary">Explore Recent Posts</a>
      <a href="/doc/" class="btn btn-secondary">Use the API</a>
      <a href="/glossary" class="btn btn-secondary">Glossary</a>
    </div>
  </div>
</section>

<div class="page-container">
<section class="metrics-section" id="group-metrics" role="region" aria-labelledby="group-metrics-title">
  <h2 class="section-title" id="group-metrics-title">Group metrics</h2>
  <div class="metrics-grid">
      {{ metric_card('Groups tracked',     (data['nbgroups'] if data and 'nbgroups' in data else None)) }}
      {{ metric_card('Relays online',      (data['online'] if data and 'online' in data else None), sublabel=('of %s total' % (data['nblocations']) if data and 'nblocations' in data else None)) }}
      {{ metric_card('DLS',   (data['nbdls'] if data and 'nbdls' in data else None)) }}
      {{ metric_card('FS',    (data['nbfs'] if data and 'nbfs' in data else None)) }}
      {{ metric_card('Chats', (data['nbchat'] if data and 'nbchat' in data else None)) }}
      {{ metric_card('Admin/Affiliates', (data['nbadmin'] if data and 'nbadmin' in data else None)) }}
  </div>
</section>

<section class="metrics-section" id="post-metrics" role="region" aria-labelledby="post-metrics-title">
  <h2 class="section-title" id="post-metrics-title">Post metrics</h2>
  <div class="metrics-grid">
      {{ metric_card('Posts (24h)',        (data['24h'] if data and '24h' in data else None)) }}
      {{ metric_card('Posts (this month)', (data['monthlypost'] if data and 'monthlypost' in data else None), sublabel=(data['month'].title() if data and 'month' in data else None)) }}
      {{ metric_card('Posts (90 days)', (data['90d'] if data and '90d' in data else None)) }}
      {{ metric_card('Posts (this year)', (data['yearlypost'] if data and 'yearlypost' in data else None), sublabel=(data['year'] if data and 'year' in data else None)) }}
      {{ metric_card('Total posts', (data['nbposts'] if data and 'nbposts' in data else None)) }}
  </div>
</section>

<section class="metrics-section" id="post-metrics" role="region" aria-labelledby="post-metrics-title">
  <h2 class="section-title" id="post-metrics-title">Other metrics</h2>
  <div class="metrics-grid">
      {{ metric_card('Markets', (data['nbforum'] if data and 'nbforum' in data else None)) }}
      {{ metric_card('Markets relays online', (data['forumonline'] if data and 'forumonline' in data else None), sublabel=('of %s total' % (data['nbforumlocations']) if data and 'nbforumlocations' in data else None)) }}
  </div>
</section>

<section class="metrics-section" id="post-metrics" role="region" aria-labelledby="post-metrics-title">
  <div class="metrics-grid">
      {{ metric_card('Parsers', (data['nbparsers'] if data and 'nbparsers' in data else None)) }}
  </div>
</section>
</div>
{% endblock %}
